{"version":10,"variables":[{"key":"AppName","type":"query","input":"fetch dt.entity.application \n|fields entity.name","multiple":false},{"key":"MilestoneGoal","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\n\nexport default async function () {\n const lastXDays = 1;\n const usqlQuery = 'SELECT DISTINCT matchingconversiongoals FROM useraction WHERE matchingconversiongoals IS NOT NULL';\n const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n const sampleCount = response.values.length;\n function flatten(arr) {\n    var flat = [];\n    for (var i = 0; i < sampleCount; i++) {\n        flat = flat.concat(arr[i]);\n    }\n    return flat;\n}\n return( flatten(response.values))\n}","multiple":false},{"key":"ConversionGoal","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\n\nexport default async function () {\n const lastXDays = 1;\n const usqlQuery = 'SELECT DISTINCT matchingconversiongoals FROM useraction WHERE matchingconversiongoals IS NOT NULL';\n const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n const sampleCount = response.values.length;\n function flatten(arr) {\n    var flat = [];\n    for (var i = 0; i < sampleCount; i++) {\n        flat = flat.concat(arr[i]);\n    }\n    return flat;\n}\n return( flatten(response.values))\n}","multiple":false},{"key":"KPI","type":"code","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nexport default async function () {\nconst lastXDays = 30;\n\nconst appName = \"www.angular.easytravel.com\"; // Change on deploy\nconst conversionGoal = \"Credit card validated\"; // Change on deploy\n\nconst query1 = 'SELECT AVG(useraction.Duration),AVG(useraction.VisuallyCompleteTime),AVG(useraction.SpeedIndex),AVG(useraction.LoadEventEnd),AVG(useraction.LargestContentfulPaint),AVG(useraction.DocumentInteractiveTime),AVG(useraction.DomCompleteTime),AVG(useraction.LoadEventStart),AVG(useraction.domContentLoadedTime) FROM usersession WHERE useraction.application=\"'+appName+'\" and usersession.usertype=\"REAL_USER\" and useraction.matchingConversionGoals=\"'+conversionGoal+'\"';\nconst query2 = 'SELECT CONDITION(AVG(useraction.Duration), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.VisuallyCompleteTime), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.SpeedIndex), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.LoadEventEnd), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.LargestContentfulPaint), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.DocumentInteractiveTime), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.DomCompleteTime), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.LoadEventStart), WHERE useraction.apdexCategory=\"FRUSTRATED\"),CONDITION(AVG(useraction.domContentLoadedTime), WHERE useraction.apdexCategory=\"FRUSTRATED\") FROM usersession WHERE useraction.application=\"'+appName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingConversionGoals=\"'+conversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\nconst query3 = 'SELECT CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.duration>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.VisuallyCompleteTime>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.SpeedIndex>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.LoadEventEnd>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.LargestContentfulPaint>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.DocumentInteractiveTime>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.DomCompleteTime>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.LoadEventStart>3000),CONDITION(COUNT(*), WHERE useraction.apdexCategory=\"FRUSTRATED\" and useraction.domContentLoadedTime>3000) FROM usersession WHERE useraction.application=\"'+appName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingConversionGoals=\"'+conversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\n\n\n\n\n    const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n    const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n    const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n\n    var crst = [];\n    var arst = [];\n    var victims = [];\n    var diffArray = [];\n\n    for (var i = 0; i <= 9; ++i) {\n        crst[i] = result1[\"values\"][0][i]/1000;\n        arst[i] = result2[\"values\"][0][i]/1000;\n        victims[i] = result3[\"values\"][0][i];\n    }\n\n    for (var i = 0; i <= 9; ++i) {\n        if (result1[\"values\"][0][i] == null || result2[\"values\"][0][i] == null) {\n            diffArray[i] = 1;\n        }\n        else {\n            diffArray[i] = ((crst[i]-arst[i])/((crst[i]+arst[i])/2) * 100)*victims[i];\n        }\n    }\n    \n    const min = Math.min(...diffArray);\n    const index = diffArray.indexOf(min);\n\n   switch (index) {\n        case 0:\n        return \"Duration\";\n       break;\n        case 1:\n        return \"VisuallyCompleteTime\";\n        break;\n        case 2:\n        return \"SpeedIndex\";\n        break;\n        case 3:\n        return \"LoadEventEnd\";\n        break;\n        case 4:\n        return \"LargestContentfulPaint\";\n        break;\n        case 5:\n        return \"DocumentInteractiveTime\";\n        break;\n        case 6:\n        return \"DomCompleteTime\";\n        break;\n        case 6:\n        return \"LoadEventStart\";\n        break;\n        case 8:\n        return \"DomContentLoadedTime\";\n        break;\n    }\n}","multiple":false},{"key":"AvgOrderValue","type":"csv","input":"100,200,300,400,500,600,700,800,900,1000","multiple":false},{"key":"Model","type":"csv","input":"5,10,15,20,25,30,40,50,60,70,80,90,100","multiple":false}],"tiles":{"5":{"title":"","type":"annotation","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"8":{"title":"","type":"annotation","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"9":{"type":"annotation","title":"","content":"![](data:image/webp;base64,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)"},"18":{"type":"code","title":"Current Conversion Rate","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst ConversionName = $ConversionGoal;\nconst MilestoneName = $MilestoneGoal;\nconst query = 'SELECT count(*) as \"Sessions\", CONDITION (count(*),WHERE useraction.matchingconversiongoals=\"'+$ConversionGoal+'\") as \"Conversions\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.matchingConversionGoals=\"'+$MilestoneGoal+'\" and usersession.usertype=\"REAL_USER\"';\nexport default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n\n  return (result[\"values\"][0][1]/result[\"values\"][0][0]*100).toFixed(2)+\"%\";\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"36":{"title":"","type":"annotation","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"97":{"type":"annotation","title":"","content":"[**Help**](https://github.com/dynatrace-perfclinics/community-tips-tricks/blob/main/ep19/ReadMeConversionFrictionAnalysis.md#user-guide)"},"98":{"title":"","type":"annotation","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"100":{"type":"code","title":"Sessions","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst query = 'SELECT count(*) as \"Sessions\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\"';\nexport default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n\n  return result[\"values\"][0][0];\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"121":{"type":"code","title":"","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst kpiName = $KPI;\nconst ConversionName = $ConversionGoal;\nconst query1 = 'SELECT AVG(useraction.'+$KPI+'),count(*) FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"';\nconst query2 = 'SELECT AVG(useraction.'+$KPI+'),count(*) FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\n\nexport default async function () {\n  const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n\n  return $KPI+\" is the KPI causing the most friction for your application. \"+result1[\"values\"][0][1]+\" sessions converted with an Average \"+$KPI+\" of \"+(result1[\"values\"][0][0]/1000).toFixed(4)+\" seconds. \"+result2[\"values\"][0][1]+\" sessions abandoned\";\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"122":{"type":"code","title":"","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst kpiName = $KPI;\nconst ConversionName = $ConversionGoal;\nconst MilestoneName = $MilestoneGoal;\nconst ModelFactor = $Model;\n\nconst query1 = 'SELECT count(*) FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>3000';\nconst query2 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"';\nconst query3 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\nconst query4 = 'SELECT count(*), CONDITION (count(*),WHERE useraction.matchingconversiongoals=\"'+$ConversionGoal+'\") FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.matchingConversionGoals=\"'+$MilestoneGoal+'\" and usersession.usertype=\"REAL_USER\"';\n\nexport default async function () {\n  const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result4 = await rumUserSessionsClient.getUsqlResultAsTable({query: query4, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  var victims = result1[\"values\"][0][0];\n  var ckpi = result2[\"values\"][0][0];\n  var akpi = result3[\"values\"][0][0];\n  var sessions = result4[\"values\"][0][0];\n  var conversions = result4[\"values\"][0][1];\n  var pconversions = (victims)*((akpi-ckpi)/(akpi))*(conversions/sessions)*$Model/100;\n  \n  return \"with an Average \"+$KPI+\" of \"+(result3[\"values\"][0][0]/1000).toFixed(4)+\" seconds. Dynatrace projects an increase of \"+(pconversions).toFixed(0)+\" conversions and a conversion rate of \"+(((conversions+pconversions)/sessions)*100).toFixed(2)+\"% if Average \"+$KPI+\" time\";\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"123":{"type":"code","title":"","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst kpiName = $KPI;\nconst ConversionName = $ConversionGoal;\nconst MilestoneName = $MilestoneGoal;\nconst ModelFactor = $Model;\n\nconst query1 = 'SELECT count(*) FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"  and useraction.'+$KPI+'>3000';\nconst query2 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"';\nconst query3 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\nconst query4 = 'SELECT count(*), CONDITION (count(*),WHERE useraction.matchingconversiongoals=\"'+$ConversionGoal+'\") FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.matchingConversionGoals=\"'+$MilestoneGoal+'\" and usersession.usertype=\"REAL_USER\"';\n\nexport default async function () {\n  const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result4 = await rumUserSessionsClient.getUsqlResultAsTable({query: query4, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  var victims = result1[\"values\"][0][0];\n  var ckpi = result2[\"values\"][0][0];\n  var akpi = result3[\"values\"][0][0];\n  var sessions = result4[\"values\"][0][0];\n  var conversions = result4[\"values\"][0][1];\n  var pconversions = (victims)*((akpi-ckpi)/(akpi))*(conversions/sessions)*$Model/100;\n  \n  return \" is reduced by \"+((akpi-ckpi)/1000).toFixed(2)+\" seconds. This will create a positive revenue projection impact of ðŸ’²\"+Intl.NumberFormat().format((pconversions*$AvgOrderValue).toFixed(2))+\" over 30 days and a projected annualized return of ðŸ’²\"+Intl.NumberFormat().format((pconversions*$AvgOrderValue*12).toFixed(2))+\".\";\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"124":{"type":"code","title":"Projected Conversion Rate","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst kpiName = $KPI;\nconst ConversionName = $ConversionGoal;\nconst MilestoneName = $MilestoneGoal;\nconst ModelFactor = $Model;\n\nconst query1 = 'SELECT count(*) FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"  and useraction.'+$KPI+'>3000';\nconst query2 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"';\nconst query3 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\nconst query4 = 'SELECT count(*), CONDITION (count(*),WHERE useraction.matchingconversiongoals=\"'+$ConversionGoal+'\") FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.matchingConversionGoals=\"'+$MilestoneGoal+'\" and usersession.usertype=\"REAL_USER\"';\n\nexport default async function () {\n  const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result4 = await rumUserSessionsClient.getUsqlResultAsTable({query: query4, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  var victims = result1[\"values\"][0][0];\n  var ckpi = result2[\"values\"][0][0];\n  var akpi = result3[\"values\"][0][0];\n  var sessions = result4[\"values\"][0][0];\n  var conversions = result4[\"values\"][0][1];\n  var pconversions = (victims)*((akpi-ckpi)/(akpi))*(conversions/sessions)*$Model/100;\n  \n  return (((conversions+pconversions)/sessions)*100).toFixed(2)+\"% ðŸ”¥\";\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"125":{"type":"code","title":"Projected Revenue Impact (30d)","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst kpiName = $KPI;\nconst ConversionName = $ConversionGoal;\nconst MilestoneName = $MilestoneGoal;\nconst ModelFactor = $Model;\n\nconst query1 = 'SELECT count(*) FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"  and useraction.'+$KPI+'>3000';\nconst query2 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\"';\nconst query3 = 'SELECT AVG(useraction.'+$KPI+') FROM usersession WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and userExperienceScore=\"FRUSTRATED\"';\nconst query4 = 'SELECT count(*), CONDITION (count(*),WHERE useraction.matchingconversiongoals=\"'+$ConversionGoal+'\") FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.matchingConversionGoals=\"'+$MilestoneGoal+'\" and usersession.usertype=\"REAL_USER\"';\n\nexport default async function () {\n  const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const result4 = await rumUserSessionsClient.getUsqlResultAsTable({query: query4, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  var victims = result1[\"values\"][0][0];\n  var ckpi = result2[\"values\"][0][0];\n  var akpi = result3[\"values\"][0][0];\n  var sessions = result4[\"values\"][0][0];\n  var conversions = result4[\"values\"][0][1];\n  var pconversions = (victims)*((akpi-ckpi)/(akpi))*(conversions/sessions)*$Model/100;\n  \n  return \"ðŸ’²\"+Intl.NumberFormat().format((pconversions*$AvgOrderValue).toFixed(2))+\" ðŸ’°\";\n}","visualization":"singleValue","visualizationSettings":{"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"126":{"type":"code","title":"Non Satisfied Abandons Over Last 7 Days ($KPI)","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\n\n\nexport default async function () {\n  const last7Days = (Math.round(new Date().getTime() / 1000)- (168 * 3600))*1000;\n  const applicationName = $AppName;\n  const ConversionName = $ConversionGoal;\n  const kpiName = $KPI;\n  const usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1m\") AS \"Date\", AVG('+$KPI+') as \"Performance\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not matchingconversiongoals=\"'+$ConversionGoal+'\" and apdexCategory<>\"SATISFIED\" and '+$KPI+'>3000 LIMIT 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -240,startTimestamp:last7Days });\n const sampleCount = response.values.length;\n  \n  return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      \n      return {\n        Date: response.values[index][0],\n        'Performance': (response.values[index][1]/1000).toFixed(2)        \n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         \n         Date: { type: 'timestamp' },\n          'Performance': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"areaChart","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","seriesOverrides":[{"seriesId":"Performance","override":{"color":"#FF0000"}}],"leftYAxisSettings":{"scale":"linear"},"legend":{"hidden":true}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"127":{"type":"code","title":"Non Satisfied Top $KPI User Actions ($KPI)","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nconst lastXDays = 30;\nconst applicationName = $AppName;\nconst kpiName = $KPI;\nconst ConversionName = $ConversionGoal;\nconst query1 = 'select distinct name as \"User Action\", count(*) as \"Requests\", avg('+$KPI+') as \"Performance\", sum('+$KPI+') as \"Total\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not matchingconversiongoals=\"'+$ConversionGoal+'\" and apdexCategory<>\"SATISFIED\" and '+$KPI+'>3000 order by Total DESC';\n\nexport default async function () {\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  const sampleCount = response.values.length;\n  \n  return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      return {\n        'User Action': response.values[index][0],\n        'Requests': response.values[index][1],\n        'AVG': (response.values[index][2]/1000).toFixed(2),\n        'SUM': (response.values[index][3]/1000).toFixed(2)\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {         \n          'User Action': { type: 'string' },\n          'Requests': { type: 'double' },\n          'AVG': { type: 'double' },\n          'SUM': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","seriesOverrides":[{"seriesId":"Performance","override":{"color":"#FF0000"}}],"leftYAxisSettings":{"scale":"linear"},"legend":{"hidden":true}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}}},"128":{"type":"annotation","title":"","content":"[**ChatGPT**](https://github.com/dynatrace-perfclinics/community-tips-tricks/blob/main/ep19/$KPI.md)"},"129":{"type":"code","title":"Non Satisfied Conversion Trend by Performance Increase For Top User Action ($KPI)","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\n\n\nexport default async function () {\n  const last7Days = (Math.round(new Date().getTime() / 1000)- (168 * 4 * 3600))*1000;\n  const applicationName = $AppName;\n  const kpiName = $KPI;\n  const ConversionName = $ConversionGoal;\n  const query1 = 'select distinct name as \"User Action\", count(*) as \"Requests\", avg('+$KPI+') as \"Performance\", sum('+$KPI+') as \"Total\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and usersession.usertype=\"REAL_USER\" and not matchingconversiongoals=\"'+$ConversionGoal+'\" and apdexCategory<>\"SATISFIED\" and '+$KPI+'>3000 order by Total DESC LIMIT 1';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: query1,offsetUtc: -240,startTimestamp:last7Days });\n  const kuaName = response[\"values\"][0][0];\n  const usqlQuery1 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'<=2000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery2 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'<=2000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery3 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>2000 and useraction.'+$KPI+'<=3000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery4 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>2000 and useraction.'+$KPI+'<=3000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery5 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>3000 and useraction.'+$KPI+'<=4000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery6 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>3000 and useraction.'+$KPI+'<=4000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery7 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>4000 and useraction.'+$KPI+'<=5000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery8 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>4000 and useraction.'+$KPI+'<=5000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery9 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>5000 and useraction.'+$KPI+'<=6000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery10 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>5000 and useraction.'+$KPI+'<=6000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery11 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>6000 and useraction.'+$KPI+'<=7000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery12 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>6000 and useraction.'+$KPI+'<=7000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery13 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>7000 and useraction.'+$KPI+'<=8000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery14 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>7000 and useraction.'+$KPI+'<=8000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery15 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>8000 and useraction.'+$KPI+'<=9000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery16 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>8000 and useraction.'+$KPI+'<=9000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery17 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>9000 and useraction.'+$KPI+'<=10000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery18 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>9000 and useraction.'+$KPI+'<=10000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery19 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.matchingconversiongoals=\"'+$ConversionGoal+'\" and useraction.'+$KPI+'>10000 and userexperiencescore<>\"SATISFIED\"';\n  const usqlQuery20 = 'SELECT count(*) as \"CNT\" FROM usersession WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+kuaName+'\" and useraction.'+$KPI+'>10000 and userexperiencescore<>\"SATISFIED\"';\n  const response1 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery1,offsetUtc: -240,startTimestamp:last7Days });\n  const response2 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery2,offsetUtc: -240,startTimestamp:last7Days });\n  const response3 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery3,offsetUtc: -240,startTimestamp:last7Days });\n  const response4 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery4,offsetUtc: -240,startTimestamp:last7Days });\n  const response5 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery5,offsetUtc: -240,startTimestamp:last7Days });\n  const response6 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery6,offsetUtc: -240,startTimestamp:last7Days });\n  const response7 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery7,offsetUtc: -240,startTimestamp:last7Days });\n  const response8 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery8,offsetUtc: -240,startTimestamp:last7Days });\n  const response9 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery9,offsetUtc: -240,startTimestamp:last7Days });\n  const response10 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery10,offsetUtc: -240,startTimestamp:last7Days });\n  const response11 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery11,offsetUtc: -240,startTimestamp:last7Days });\n  const response12 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery12,offsetUtc: -240,startTimestamp:last7Days });\n  const response13 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery13,offsetUtc: -240,startTimestamp:last7Days });\n  const response14 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery14,offsetUtc: -240,startTimestamp:last7Days });\n  const response15 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery15,offsetUtc: -240,startTimestamp:last7Days });\n  const response16 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery16,offsetUtc: -240,startTimestamp:last7Days });\n  const response17 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery17,offsetUtc: -240,startTimestamp:last7Days });\n  const response18 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery18,offsetUtc: -240,startTimestamp:last7Days });\n  const response19 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery19,offsetUtc: -240,startTimestamp:last7Days });\n  const response20 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery20,offsetUtc: -240,startTimestamp:last7Days });\n\nreturn {\n    records: [\n  {\n        'Bucket': \"<=2s\",\n        'CR': response1[\"values\"][0][0]/response2[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"2s-3s\",\n        'CR': response3[\"values\"][0][0]/response4[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"3s-4s\",\n        'CR': response5[\"values\"][0][0]/response6[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"4s-5s\",\n        'CR': response7[\"values\"][0][0]/response8[\"values\"][0][0]*100\n      },\n  {\n        'Bucket': \"5s-6s\",\n        'CR': response9[\"values\"][0][0]/response10[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"6s-7s\",\n        'CR': response11[\"values\"][0][0]/response12[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"7s-8s\",\n        'CR': response13[\"values\"][0][0]/response14[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"8s-9s\",\n        'CR': response15[\"values\"][0][0]/response16[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"9s-10s\",\n        'CR': response17[\"values\"][0][0]/response18[\"values\"][0][0]*100\n      },\n  {      'Bucket': \">10s\",\n        'CR': response19[\"values\"][0][0]/response20[\"values\"][0][0]*100\n      },\n],\n    types: [\n      {\n        indexRange: [0, 2],\n        mappings: {\n          'Bucket': { type: 'string' },\n          'CR': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","legend":{"hidden":true}},"singleValue":{"showLabel":true,"label":"","autoscale":true},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]}},"visualization":"categoricalBarChart"}},"layouts":{"5":{"x":0,"y":3,"w":24,"h":1},"8":{"x":0,"y":0,"w":24,"h":1},"9":{"x":0,"y":1,"w":10,"h":2},"18":{"x":14,"y":1,"w":3,"h":2},"36":{"x":0,"y":10,"w":24,"h":1},"97":{"x":22,"y":19,"w":2,"h":1},"98":{"x":0,"y":19,"w":20,"h":1},"100":{"x":11,"y":1,"w":3,"h":2},"121":{"x":0,"y":4,"w":23,"h":2},"122":{"x":0,"y":6,"w":23,"h":2},"123":{"x":0,"y":8,"w":23,"h":2},"124":{"x":17,"y":1,"w":3,"h":2},"125":{"x":20,"y":1,"w":3,"h":2},"126":{"x":0,"y":20,"w":23,"h":12},"127":{"x":0,"y":11,"w":8,"h":8},"128":{"x":20,"y":19,"w":2,"h":1},"129":{"x":8,"y":11,"w":15,"h":8}}}